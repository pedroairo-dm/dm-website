---
layout: post
title: Query and visualize hierarchical data
date: 2015-01-28 11:20:00.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- CRM 2015
tags: []
meta:
  _publicize_pending: '1'
  sharing_disabled: '1'
  _import_session_id: 61e12c43ccaa7
  _import_original_post_id: '54061'
author:
  login: pedroairo
  email: pedroairo@dynamicsmonster.com
  display_name: pedroairo
  first_name: ''
  last_name: ''
permalink: "/2015/01/28/query-and-visualize-hierarchical-data/"
---
<div>
<div>
<div>
<h1 class="title" style="font-weight:normal;line-height:1.167;margin-top:0;font-stretch:normal;"><span style="font-size:x-small;"><font face="Arial, Helvetica, sans-serif">I remember in 2005 in the CRM 2015 i was asked to do something similar, and only now Microsoft makes that available OOB.</font></span></h1>
<div>
<div style="font-size:13px;line-height:18px;padding-bottom:15px;color:rgb(42,42,42);"><font face="Arial, Helvetica, sans-serif">Applies To: CRM 2015 on-prem, CRM Online</font></div>
<div id="mainSection" style="color:rgb(42,42,42);font-size:13px;line-height:17.55px;clear:both;">
<div id="mainBody">
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">You can get valuable business insights by visualizing hierarchically related data. The Microsoft Dynamics CRM hierarchical modelling and visualization capabilities give you a number of benefits:</font></div>
<ul>
<li class="unordered" style="list-style-image:none;"><font face="Arial, Helvetica, sans-serif">View and explore complex hierarchical information.<br /></font></li>
<li class="unordered" style="list-style-image:none;"><font face="Arial, Helvetica, sans-serif">View key performance indicators (KPIs) in the contextual view of a hierarchy.<br /></font></li>
<li class="unordered" style="list-style-image:none;"><font face="Arial, Helvetica, sans-serif">Visually analyze key information across the web and the tablets.<br /></font></li>
</ul>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">For some entities, such as account and user, the visualizations are provided out-of-the-box. Other entities, including custom entities, can be enabled for a hierarchy and you can create the visualizations for them. Based on your needs, you can choose between using a tree view, which shows the entire hierarchy, or a tile view, which depicts a smaller portion of the hierarchy. Both views are shown side by side. You can explore a hierarchy by expanding and contracting a hierarchy tree. The same hierarchical settings for visualization are set once, but apply to both Microsoft Dynamics CRM and Microsoft Dynamics CRM for tablets. In tablets, the visuals render in a modified format suitable for the smaller form factor. The customizable components required for hierarchical visualization are solution aware, therefore, they can be transported between organizations like any other customization. You can configure the attributes shown in the visualization by customizing a Quick Form using the form editor. There is no requirement to write code.</font></div>
<div>
<h2 class="LW_CollapsibleArea_TitleDiv" style="font-weight:normal;margin:9px 0 19px;padding:0;font-size:13px;"><a class="LW_CollapsibleArea_TitleAhref" href="https://www.blogger.com/null" style="outline:none;color:black;" title="Click to collapse. Double-click to collapse all."><font face="Arial, Helvetica, sans-serif"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img" style="background-image:url('https://i-technet.sec.s-msft.com/Areas/Epx/Content/Images/ImageSprite.png?v=635573663203311291');background-position:-470px -3px;background-repeat:no-repeat;border-width:0;display:block;float:left;height:12px;margin-bottom:0;margin-top:10px;overflow:hidden;padding:0 5px 0 0;vertical-align:middle;width:9px;background-attachment:scroll;"></span><span class="LW_CollapsibleArea_Title" style="display:block;font-size:1.692em;color:rgb(42,42,42);">In This Topic</span></font></a></h2>
<div class="LW_CollapsibleArea_HrDiv" style="padding-top:0;"></div>
<div class="sectionblock" style="padding-left:15px;padding-bottom:20px;">
<div style="padding-bottom:15px;line-height:18px;"><a href="https://technet.microsoft.com/en-us/library/dn832068.aspx#BKMK_Querydata" style="text-decoration:none;color:rgb(0,102,221);"><font face="Arial, Helvetica, sans-serif">Query hierarchical data</font></a></div>
<div style="padding-bottom:15px;line-height:18px;"><a href="https://technet.microsoft.com/en-us/library/dn832068.aspx#BKMK_Visualizedata" style="text-decoration:none;color:rgb(0,102,221);"><font face="Arial, Helvetica, sans-serif">Visualize hierarchical data</font></a></div>
</div>
</div>
<p><font face="Arial, Helvetica, sans-serif"><a href="https://www.blogger.com/null" id="BKMK_Querydata" style="color:rgb(0,116,158);"></a></font><br />
<h2 class="heading" style="font-weight:normal;margin:0;padding-bottom:5px;padding-top:5px;font-size:1.692em;"><font face="Arial, Helvetica, sans-serif">Query hierarchical data</font></h2>
<div class="section" id="sectionSection1">
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">In Microsoft Dynamics CRM, hierarchical data structures are supported by self-referential one-to-many (1:N) relationships of the related records. In the past, to view hierarchical data, you had to iteratively query for the related records. Presently, you can query the related data as a hierarchy, in one step. You’ll be able to query records using the <b>Under</b> and <b>Not Under</b> logic. The <b>Under</b> and <b>Not Under</b> hierarchical operators are exposed in Advanced Find and the workflow editor. For more information about how to use these operators, see <a href="https://technet.microsoft.com/en-us/library/dn531057.aspx" style="text-decoration:none;color:rgb(0,102,221);">Configure workflow steps</a>. For more information about Advanced Find, see <a href="http://go.microsoft.com/fwlink/p/?LinkId=513227" style="text-decoration:none;color:rgb(0,102,221);">Create, edit, or save an Advanced Find search</a></font></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">The following examples illustrate various scenarios for querying hierarchies:</font></div>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Query account hierarchy</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Query accounts in the account hierarchy" id="a6dde387-69f5-44d3-9a8b-7c0adc88916a" src="{{ site.baseurl }}/assets/2015/01/IC757790.png" style="border:0;" title="Query accounts in the account hierarchy" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Query account hierarchy, including related activities</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Query account's related activities" id="3d10295a-3bcb-4565-9461-d9eededeae08" src="{{ site.baseurl }}/assets/2015/01/IC757791.png" style="border:0;" title="Query account's related activities" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Query account hierarchy, including related opportunities</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Query account's related opportunities" id="05de6e9c-ad46-4987-9651-6c98eef273df" src="{{ site.baseurl }}/assets/2015/01/IC766319.png" style="border:0;" title="Query account's related opportunities" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">To query the data as a hierarchy, you must set one of the entity’s one-to-many (1:N) self-referential relationships as hierarchical. To turn the hierarchy on, in <b>Settings</b> &gt; <b>Customizations</b> &gt; <b>Customizer your system</b> &gt;<b>Components</b> &gt; <b>Entity</b> &gt; <b>1:N Relationships</b>, choose a (1:N) relationship and in the <b>Relationship definition</b>, set <b>Hierarchical</b> to <b>Yes</b>.</font></div>
<div class="alert">
<table style="border-left-width:1px;border-spacing:0;border-style:solid none none solid;border-top-color:rgb(187,187,187);border-top-width:1px;margin-bottom:20px;margin-top:20px;padding:0;width:1258px;border-left-color:rgb(187,187,187);">
<tbody>
<tr>
<th align="left" style="background-color:rgb(237,237,237);border-bottom-color:rgb(187,187,187);border-bottom-width:1px;border-right-color:rgb(187,187,187);border-right-width:1px;border-style:none solid solid none;color:rgb(99,99,99);padding:10px 8px;"><font face="Arial, Helvetica, sans-serif"><img alt="note" class="cl_IC101471" id="note" src="{{ site.baseurl }}/assets/2015/01/clear.gif" style="border:0;height:14px;overflow:hidden;padding-right:5px;width:16px;background:url('https://i-technet.sec.s-msft.com/Areas/Epx/Content/Images/ImageSprite.png?v=635573663203311291') -1228px -3px no-repeat scroll;" title="note" />Note</font></th>
</tr>
<tr>
<td style="border-bottom-color:rgb(187,187,187);border-bottom-width:1px;border-right-color:rgb(187,187,187);border-right-width:1px;border-style:none solid solid none;color:rgb(42,42,42);padding:10px 8px;vertical-align:top;"><font face="Arial, Helvetica, sans-serif">Some of the out-of the-box (1:N) relationships can’t be customized. This will prevent you from setting those relationships as hierarchical.</font>
<div style="padding-bottom:0;line-height:18px;"></div>
</td>
</tr>
</tbody>
</table>
<div style="padding-bottom:15px;line-height:18px;"></div>
</div>
</div>
<p><font face="Arial, Helvetica, sans-serif"><a href="https://www.blogger.com/null" id="BKMK_Visualizedata" style="color:rgb(0,116,158);"></a></font><br />
<h2 class="heading" style="font-weight:normal;margin:0;padding-bottom:5px;padding-top:5px;font-size:1.692em;"><font face="Arial, Helvetica, sans-serif">Visualize hierarchical data</font></h2>
<div class="section" id="sectionSection2">
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">The system entities that have visualizations available out-of-the-box include <b>Account</b>, <b>Position</b>, <b>Product</b>, and <b>User</b>. In the grid view of these entities, you can see the icon depicting the hierarchy chart, to the left of the record name. The hierarchy icon isn’t present for all records by default. The icon is shown for the records that have a parent record, a child record, or both.</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Active accounts" id="3cf35c47-7786-40dd-a4b5-374ef76118c9" src="{{ site.baseurl }}/assets/2015/01/IC753310.png" style="border:0;" title="Active accounts" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">If you select the hierarchy icon, you can view the hierarchy, with the tree view on the left and the tile view on the right, as shown below:</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Account tree and tile view in Dynamics CRM" id="9b67102f-40e8-41cb-9142-36dde01857d9" src="{{ site.baseurl }}/assets/2015/01/IC766321.png" style="border:0;" title="Account tree and tile view in Dynamics CRM" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">A few other out-of the-box system entities can be enabled for a hierarchy. These entities include <b>Case</b>, <b>Contact</b>, <b>Opportunity</b>, <b>Order</b>, <b>Quote</b>, <b>Campaign</b>, and <b>Team</b>. All custom entities can be enabled for a hierarchy.</font></div>
<div class="alert">
<table style="border-left-width:1px;border-spacing:0;border-style:solid none none solid;border-top-color:rgb(187,187,187);border-top-width:1px;margin-bottom:20px;margin-top:20px;padding:0;width:1258px;border-left-color:rgb(187,187,187);">
<tbody>
<tr>
<th align="left" style="background-color:rgb(237,237,237);border-bottom-color:rgb(187,187,187);border-bottom-width:1px;border-right-color:rgb(187,187,187);border-right-width:1px;border-style:none solid solid none;color:rgb(99,99,99);padding:10px 8px;"><font face="Arial, Helvetica, sans-serif"><img alt="Tip" id="Tip" src="{{ site.baseurl }}/assets/2015/01/IC115537.gif" style="padding-right:5px;border:0;" title="Tip" />Tip</font></th>
</tr>
<tr>
<td style="border-bottom-color:rgb(187,187,187);border-bottom-width:1px;border-right-color:rgb(187,187,187);border-right-width:1px;border-style:none solid solid none;color:rgb(42,42,42);padding:10px 8px;vertical-align:top;"><font face="Arial, Helvetica, sans-serif">If an entity can be enabled for a hierarchy, in <b>Settings</b> &gt; <b>Customizations</b> &gt; <b>Customizer your system</b> &gt; <b>Components</b> &gt; <b>Entity</b>, you see the selection called <b>Hierarchy Settings</b>. The entities that can’t be enabled for a hierarchy don’t have this selection.</font>
<div style="padding-bottom:0;line-height:18px;"></div>
</td>
</tr>
</tbody>
</table>
<div style="padding-bottom:15px;line-height:18px;"></div>
</div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Important things to remember when you create visualizations:</font></div>
<ul>
<li class="unordered" style="list-style-image:none;"><font face="Arial, Helvetica, sans-serif">Only one (1: N) self-referential relationship per entity can be set as hierarchical. In this relationship the primary entity and the related entity must be of the same type, such as account_parent_account or new_new_widget_new_widget.<br /></font></li>
<li class="unordered" style="list-style-image:none;"><font face="Arial, Helvetica, sans-serif">Presently, a hierarchy or visualization is based on one entity only. You can depict the account hierarchy showing accounts at multiple levels, but you can’t show accounts and contacts in the same hierarchy visualization.<br /></font></li>
<li class="unordered" style="list-style-image:none;"><font face="Arial, Helvetica, sans-serif">Maximum number of fields that can be displayed in a tile is four. If you add more fields to the Quick Form that is used for the tile view, only the first four fields will be displayed.<br /></font></li>
</ul>
<div>
<h3 class="LW_CollapsibleArea_TitleDiv" style="font-weight:normal;margin:9px 0 19px;padding:0;font-size:13px;"><a class="LW_CollapsibleArea_TitleAhref" href="https://www.blogger.com/null" style="outline:none;color:black;" title="Click to collapse. Double-click to collapse all."><font face="Arial, Helvetica, sans-serif"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img" style="background-image:url('https://i-technet.sec.s-msft.com/Areas/Epx/Content/Images/ImageSprite.png?v=635573663203311291');background-position:-470px -3px;background-repeat:no-repeat;border-width:0;display:block;float:left;height:12px;margin-bottom:0;margin-top:10px;overflow:hidden;padding:0 5px 0 0;vertical-align:middle;width:9px;background-attachment:scroll;"></span><span class="LW_CollapsibleArea_Title" style="display:block;font-size:1.692em;color:rgb(42,42,42);">Visualization example</span></font></a></h3>
<div class="LW_CollapsibleArea_HrDiv" style="padding-top:0;"></div>
<div class="sectionblock" style="padding-left:15px;padding-bottom:20px;">
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Let’s look at an example of creating the visualization for a custom entity. We created a custom entity called new_Widget, created a (1:N) self-referential relationship <b>new_new_widget_new_widget</b> and marked it as hierarchical, as shown here.</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Widget relationship definition" id="324c359e-2970-4740-9370-6bad9ad53ad8" src="{{ site.baseurl }}/assets/2015/01/IC753312.png" style="border:0;" title="Widget relationship definition" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Next, in the <b>Hierarchy Settings</b> grid view, we selected the <b>new_new_widget_new_widget</b> hierarchical relationship. In the form, we filled in the required fields. If you haven’t yet marked the (1:N) relationship as hierarchical, the link on the form will take you back to the relationship definition form, where you can mark the relationship as hierarchical.</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Hierarchy settings" id="7c4749fb-2420-4e41-b91c-5550f7b65384" src="{{ site.baseurl }}/assets/2015/01/IC753315.png" style="border:0;" title="Hierarchy settings" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">For the <b>Quick View Form</b>, we created a Quick Form called <b>Widget Hierarchy Tile Form</b>. In this form, we added four fields to display in each tile.</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Create quick form for widget" id="df6a2ae5-142b-4e96-8616-462698ff699b" src="{{ site.baseurl }}/assets/2015/01/IC753316.png" style="border:0;" title="Create quick form for widget" /></font>
<div style="padding-bottom:15px;line-height:18px;"></div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">After we completed the setup, we created two records: Standard Widget and Premium Widget. After making the Premium Widget a parent of the Standard Widget by using the lookup field, the new_Widget grid view depicted the hierarchy icons, as shown below:</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Widget's hierarchy grid" id="5aa0e56c-3302-468a-95ce-54a88d096877" src="{{ site.baseurl }}/assets/2015/01/IC753317.png" style="border:0;" title="Widget's hierarchy grid" /></font>
<div class="alert">
<table style="border-left-width:1px;border-spacing:0;border-style:solid none none solid;border-top-color:rgb(187,187,187);border-top-width:1px;margin-bottom:20px;margin-top:20px;padding:0;width:1243px;border-left-color:rgb(187,187,187);">
<tbody>
<tr>
<th align="left" style="background-color:rgb(237,237,237);border-bottom-color:rgb(187,187,187);border-bottom-width:1px;border-right-color:rgb(187,187,187);border-right-width:1px;border-style:none solid solid none;color:rgb(99,99,99);padding:10px 8px;"><font face="Arial, Helvetica, sans-serif"><img alt="Tip" id="Tip" src="{{ site.baseurl }}/assets/2015/01/IC115537.gif" style="padding-right:5px;border:0;" title="Tip" />Tip</font></th>
</tr>
<tr>
<td style="border-bottom-color:rgb(187,187,187);border-bottom-width:1px;border-right-color:rgb(187,187,187);border-right-width:1px;border-style:none solid solid none;color:rgb(42,42,42);padding:10px 8px;vertical-align:top;"><font face="Arial, Helvetica, sans-serif">The hierarchy icons don’t appear in the record grid view until the records are paired in the parent – child relationship.</font>
<div style="padding-bottom:0;line-height:18px;"></div>
</td>
</tr>
</tbody>
</table>
<div style="padding-bottom:15px;line-height:18px;"></div>
</div>
<div style="padding-bottom:15px;line-height:18px;"><font face="Arial, Helvetica, sans-serif">Choosing the hierarchy icon displays the new_Widget hierarchy with the tree view on the left and the tile view on the right, showing two records. Each tile contains four fields that we provided in the <b>Widget Hierarchy Tile Form</b>.</font></div>
<p><font face="Arial, Helvetica, sans-serif"><img alt="Widget's tree and tiles views" id="5a655547-3ef5-4bae-b717-9b3c62a25295" src="{{ site.baseurl }}/assets/2015/01/IC753318.png" style="border:0;" title="Widget's tree and tiles views" /></font></div>
</div>
</div>
</div>
</div>
</div>
<div><span style="font-size:x-small;font-family:Verdana , sans-serif;"><br /></span></div>
</div>
</div>
</div>
