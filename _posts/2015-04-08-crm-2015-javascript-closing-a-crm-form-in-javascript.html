---
layout: post
title: CRM 2015 - Javascript - Closing a CRM Form in Javascript
date: 2015-04-08 08:20:16.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- CRM 2015
tags:
- Javascript
meta:
  _publicize_pending: '1'
  sharing_disabled: '1'
  _import_session_id: 61e12c43ccaa7
  _import_original_post_id: '88073'
author:
  login: pedroairo
  email: pedroairo@dynamicsmonster.com
  display_name: pedroairo
  first_name: ''
  last_name: ''
permalink: "/2015/04/08/crm-2015-javascript-closing-a-crm-form-in-javascript/"
---
<div>
<div>
<div>
<p><font size="2"><br /></font></p>
<p><font size="2">I had the need of adding an additional button to a form &quot;Submit and Close&quot; for business process purposes.</font></p>
<p><font size="2"><br /></font></p>
<p><font size="2">In there doing some code, in the end only needed to call to do whatever i needed:</font></p>
<p><font size="2"><br /></font></p>
<p><font face="Arial, Helvetica, sans-serif" size="2"><span>Xrm.Page.data.entity.save(&quot;saveandclose&quot;);</span><br /></font></p>
<p><span><font size="2"><span><font face="Arial, Helvetica, sans-serif">Xrm.Page.ui.close();</font></span><br /></font></span></p>
<p><span><font size="2"><br /></font></span></p>
<p><span><font size="2">However, doing that, and because i was calling the for from a Web Resource, the form was being closed but the originating web resource was appearing, the solution is simple, change the last line by:</font></span></p>
<p><span><font size="2"><br /></font></span></p>
<p><span><font size="2"><span><font face="Arial, Helvetica, sans-serif">if (parent.opener != undefined) { window.parent.close(); } else Xrm.Page.ui.close();</font></span><br /></font></span></p>
<p><span><font size="2"><br /></font></span></p>
<p><span><font size="2">In my perspective, it seems that CRM if has a parent.opener, just redirects to that location, even if we are calling the close of the window trough the Xrm.Page.Ui object.</font></span></p>
<p><span><font size="2"><br /></font></span></p>
<p><span><font size="2">Any thoughts, please let me know.</font></span></p>
<p><span><font size="2"><br /></font></span></p>
<p><span><font size="2">Hope is useful.</font></span></p>
<p><span><font size="2"><br /></font></span></p>
<p></p>
</div>
</div>
</div>
