---
layout: post
title: Configure Exchange folder-level tracking rules
date: 2015-11-17 08:49:48.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- CRM 2015
tags:
- Exchange
meta:
  _publicize_pending: '1'
  sharing_disabled: '1'
  _import_session_id: 61e12c43ccaa7
  _import_original_post_id: '287003'
author:
  login: pedroairo
  email: pedroairo@dynamicsmonster.com
  display_name: pedroairo
  first_name: ''
  last_name: ''
permalink: "/2015/11/17/configure-exchange-folder-level-tracking-rules/"
---
<div>
<div>
<div>
<p><font size="2">If you need to configure a specific Microsoft Exchange folder to track the emails and run a workflow process configured in crm, it is possible trough few lines of code.</font></p>
<p><font size="2"><br /></font></p>
<p><font size="2">Let's assume that you have configured a folder in the Microsoft Exchange to keep emails sent by a specific (individual contact or company).</font></p>
<p><font size="2"><br /></font></p>
<p><font size="2">The code needed for this is:</font></p>
<p><font size="2"><br /></font></p>
<p><u><font size="2">To create and manage folder-level tracking rules:</font></u></p>
<p></p>
</div>
</div>
<div>
<div><span><font face="Arial, Helvetica, sans-serif" size="2">// Create a folder-level tracking rule <br />MailboxTrackingFolder newTrackingFolder = new MailboxTrackingFolder(); <br />// Set the required attributes newTrackingFolder.ExchangeFolderId = &quot;123456&quot;; <br />// Sample value. Retrieve this value using Exchange Web Services (EWS) <br />newTrackingFolder.MailboxId = new EntityReference(Mailbox.EntityLogicalName, _mailboxId); <br />// Set the optional attributes <br />newTrackingFolder.RegardingObjectId = new EntityReference(Account.EntityLogicalName, _accountId); newTrackingFolder.RegardingObjectId.Name = _accountName; <br />newTrackingFolder.ExchangeFolderName = &quot;Sample Exchange Folder&quot;; <br />// Execute the request to create the rule <br /> _folderTrackingId = _serviceProxy.Create(newTrackingFolder); Console.WriteLine(&quot;Created folder-level tracking rule for '{0}'.n&quot;, _mailboxName);</font></span></div>
</div>
<div>
<div>
<p><span><u><font size="2">You can create a maximum of 25 folder-level tracking rules per mailbox.</font></u></span></p>
<p><span><b><font size="2"><br /></font></b></span></p>
<p><u><font size="2">To <span style="background-color:transparent;line-height:normal;color:rgb(56,56,56);">Retrieve folder-level tracking rules for a mailbox:</span></font></u></p>
</div>
</div>
<div>
<div>
<div style="overflow:auto;">
<table style="float:left;width:100%;">
<tbody>
<tr>
<td width="100%"><font color="#000000" face="Arial, Helvetica, sans-serif" size="2"> // Retrieve the folder mapping rules for a mailbox <br />RetrieveMailboxTrackingFoldersRequest req = new RetrieveMailboxTrackingFoldersRequest { MailboxId = _mailboxId.ToString() }; <br />RetrieveMailboxTrackingFoldersResponse resp = (RetrieveMailboxTrackingFoldersResponse_serviceProxy.Execute(req); <br />Console.WriteLine(&quot;Retrieved folder-level tracking rules for {0}:&quot;, _mailboxName); <br />int n = 1; <br />foreach (var folderMapping in resp.MailboxTrackingFolderMappings) { <br /> Console.WriteLine(&quot;tRule {0}: '{1}' is mapped to '{2}'.&quot;, n, folderMapping.ExchangeFolderName, folderMapping.RegardingObjectName); <br /> n++;<br /> }</font></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div>
<div>
<p><font size="2">Code in here from CRM 2015 SDK.</font></p>
<p><font size="2"><br /></font></p>
<p><font size="2">Hope this can be helpful. </font></p>
</div>
</div>
</div>
